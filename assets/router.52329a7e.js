import{r as D,i as H,a as Q,E as y,u as k,M as $,T as M,d as Y,b as Z,I as O,c as ee,e as te,A as se,f as re,g as B,h as ae,j as ne}from"./appRouter.cfa3116b.js";import{j as e,Q as w,a as n,F as x,r as u}from"./index.98a4bc96.js";import{d as _,N as b,R as A,O as ie,u as R,a as oe,b as g,e as le,c as ce}from"./404.44482caf.js";import{C as z,S as ue,M as de,B as me,a as N,b as ge,u as L,I}from"./index.esm.1f0f93a7.js";var V={},he=H.exports;Object.defineProperty(V,"__esModule",{value:!0});var P=V.default=void 0,pe=he(D()),fe=Q,xe=(0,pe.default)((0,fe.jsx)("path",{d:"m14.06 9.02.92.92L5.92 19H5v-.92l9.06-9.06M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z"}),"EditOutlined");P=V.default=xe;const ve=()=>{const{id:t}=_();if(!t)return e(y,{message:"Missing assessment Id"});const{assessment:s,error:r,loading:i}=k(t);return e($,{bgImg:s==null?void 0:s.thumbnailUrl,children:i?e(w,{}):r?e(y,{message:r.toString()}):s!==void 0?n(x,{children:[e("div",{className:"my-2 mb-12",children:e(M,{title:s.title,back:!0,cta:e(b,{to:"./edit",children:e(P,{})})})}),n(A,{spacing:4,className:"mb-8",items:"center",children:[e(b,{to:"./details",className:({isActive:a})=>(a?"bg-blue text-white rounded-md hover:text-white":"text-main hover:text-main")+" px-4 py-2",children:"Detalles"}),e(b,{to:"./questions",className:({isActive:a})=>(a?"bg-blue text-white rounded-md hover:text-white":"text-main hover:text-main")+" px-4 py-2",children:"Preguntas"}),e(b,{to:"./ratings",className:({isActive:a})=>(a?"bg-blue text-white rounded-md hover:text-white":"text-main hover:text-main")+" px-4 py-2",children:"Rese\xF1as"})]}),e(ie,{})]}):e(x,{})})},be=t=>e(b,{to:`/MRP.WebApp/assessments/${t.id}`,children:e("div",{className:"rounded-md bg-surface-4 text-main hover:bg-surface-5 transition-colors duration-300 overflow-hidden shadow-sm outline outline-solid outline-surface-2 hover:outline-white hover:shadow-glow w-full ",children:n("div",{className:"grid grid-cols-[minmax(2rem,8rem)_1fr_2rem] items-center pr-4",children:[t.thumbnailUrl!==void 0?e("img",{src:t.thumbnailUrl,className:"w-f self-stretch object-cover grow"}):e("div",{}),n("div",{className:"grow p-4 flex items-start self-start flex-col pointer-events-none",children:[t.categories!==void 0&&e(z,{elements:t.categories}),e("h3",{className:"text-3xl mb-2",children:t.title}),t.description!==void 0&&e("p",{className:"mb-4",children:t.description})]}),e(Y,{color:"info"})]})})}),ye=t=>e("div",{className:"flex flex-col gap-8",children:t.assessments!==void 0&&t.assessments.map(s=>e(be,{...s},s.id))}),Ne=t=>{const[s,r]=u.exports.useState([]),i=()=>{if(!t.assessments)return r([]);const a=[];for(var o=0;o<t.assessments.length;o++){const c=t.assessments[o];for(var l=0;l<c.categories.length;l++){const d=c.categories[l];a.includes(d)||a.push(d)}}r(a)};return u.exports.useMemo(()=>{i()},[t.assessments]),n("div",{className:"max-w-xs rounded-md",children:[e("h2",{className:"mb-2",children:"Filtros"}),n("div",{className:"flex flex-row gap-4 items-center relative my-4",children:[e("h3",{className:"mt-4 hidden","aria-hidden":!0,children:"Buscar"}),e("input",{type:"text",id:"query",placeholder:"Buscar",autoComplete:"off","aria-label":"Buscar",className:"outline outline-neutral-70 w-full mt-2 placeholder:text-neutral-50 pl-10",onChange:a=>t.dispatch({property:"query",value:a.currentTarget.value})}),e(ue,{className:"absolute left-2 mt-1 top-1/2 -translate-y-1/2"})]}),e("h3",{className:"mt-4",children:"Categor\xEDas"}),e(de,{allOptions:s,selectedOptions:t.state.categories,onChange:a=>t.dispatch({property:"categories",value:a})})]})},we=(t,s)=>{switch(s.property){case"categories":return t.categories.includes(s.value)?{...t,categories:t.categories.filter(r=>r!=s.value)}:{...t,categories:[s.value,...t.categories]};case"query":return{...t,query:s.value};default:return console.error("Unkown action property"),{...t}}},Ce=()=>{const{assessments:t,loading:s,error:r}=Z(),[i,a]=u.exports.useReducer(we,{categories:[],query:""}),o=u.exports.useMemo(()=>{if(!t)return[];const l=i.query!="",c=i.categories.length>0,d=new RegExp(i.query,"ig");return t.filter(p=>(!c||p.categories.some(f=>i.categories.includes(f)))&&(!l||[p.title,p.categories.join(" "),p.description].some(f=>f!==void 0&&d.test(f))))},[t,i.categories,i.query]);return n($,{sidebar:e(Ne,{assessments:t,state:i,dispatch:a}),children:[e(M,{cta:e(b,{to:"new",className:"block",children:e(me,{variant:"contained",children:"Crear nuevo Quiz"})}),title:"Quizes"}),s?e(w,{}):e(x,{}),r?e(N,{type:"error",title:"Error",message:r.toString()}):e(x,{}),!s&&!r?e(ye,{assessments:o}):e(x,{})]})};var T={},Se=H.exports;Object.defineProperty(T,"__esModule",{value:!0});var j=T.default=void 0,qe=Se(D()),Ee=Q,Ae=(0,qe.default)((0,Ee.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"AddOutlined");j=T.default=Ae;const G=t=>{const s=u.exports.useRef(null),[r,i]=u.exports.useState(t.defaultValue||[]),a=t.name[0].toLocaleUpperCase()+t.name.slice(1),o=()=>{s===null||s.current===null||(i([s.current.value.trim(),...r]),s.current.value="")},l=c=>{i(r.filter(d=>d!==c.value))};return u.exports.useEffect(()=>{t.setValue(t.name+"[]",r)},[r]),n("div",{className:"flex flex-col gap-4 w-full",children:[e("input",{type:"hidden",...t.register(t.name+"[]")}),n("div",{className:"flex flex-row gap-4 w-full items-end",children:[n("div",{className:"flex flex-col gap-1 grow",children:[n("label",{htmlFor:"multiselect",children:[a,":"]}),e("textarea",{onKeyUp:c=>{c.key=="Enter"&&(c.preventDefault(),o())},onSubmit:c=>{c.preventDefault(),o()},rows:1,className:"resize-none",placeholder:a,id:"multiselect",ref:s})]}),e(O,{"aria-label":"add",onClick:o,children:e(j,{color:"primary"})})]}),e(A,{spacing:4,wrap:!0,children:r.map(c=>e(ge,{color:"primary",label:c,onDelete:()=>l({value:c})},c))})]})},Me=()=>{const{register:t,handleSubmit:s,setValue:r,formState:i}=L(),[a,o]=u.exports.useState(),[l,c]=u.exports.useState(!1),d=R(),p=m=>{o({type:"info",content:`"${m.title}" se cre\xF3 exitosamente`}),c(!0),setTimeout(()=>d("../"),2e3)},f=m=>{o({type:"error",content:m})},{mutate:S,error:q,isLoading:C}=ee(p,f),E=m=>{confirm(`\xBFCrear ${m.title}?`)&&S(m)};return n("form",{onSubmit:s(m=>E(m)),className:"text-left flex flex-col items-stretch gap-6 mb-16 relative",children:[!!q&&e(N,{type:"error",title:"Error",message:q.toString()}),a!==void 0&&e(N,{type:a.type,message:a.content,title:a.type=="error"?"Error":"\xC9xito"}),!l&&n("div",{className:"flex flex-col gap-4",children:[e(I,{type:"text",register:t,name:"title",required:!0}),e(I,{type:"textarea",register:t,name:"description"}),e(G,{register:t,name:"categories",setValue:r})]}),C?e(w,{}):e("input",{type:"submit",value:"Crear",disabled:!i.isValid&&!l,className:"px-8 py-2 bg-blue rounded-md text-white cursor-pointer hover:bg-primary-40 mx-auto"})]})},Fe=()=>n($,{children:[n(A,{spacing:2,items:"center",wrap:!1,children:[e(b,{to:"../",className:"mb-8",children:e(te,{})}),e("h1",{className:"mb-8 grow",children:"Nuevo Quiz"})]}),e(Me,{})]}),Ie=()=>{const{id:t}=_();if(!t)return e(y,{message:"Missing assessment Id"});const{assessment:s,error:r,loading:i}=k(t);return i?e(w,{}):r?e(y,{message:r.toString()}):s!==void 0?n(x,{children:[e(M,{title:"Detalles"}),e("h2",{children:"Categor\xEDas"}),s.categories!==void 0&&e(z,{elements:s.categories}),e("hr",{className:"my-4"}),e("h2",{className:"mb-2",children:"Descripci\xF3n"}),e("p",{className:"mb-8",children:s.description!==void 0?s.description:"Sin descripci\xF3n"}),e("hr",{className:"my-4"}),e("h2",{className:"mb-4",children:"Vista Previa"}),e("div",{className:"p-8 rounded-md bg-surface-2",children:e(se,{...s,id:t})})]}):e(x,{})};function _e(t){return n("div",{className:[t.question.correctOption?"bg-surface-5":"bg-surface-2","rounded-md p-4"].join(" "),children:[n(A,{spacing:2,className:"mb-4",children:[e(b,{to:t.question._id,className:"inline-block",children:e(P,{})}),e("h3",{className:"mb-0 text-2xl font-bold inline-block leading-6",children:t.question.title})]}),t.question.options.map((s,r)=>n("div",{className:["p-2 flex flex-row gap-4",s.isCorrectAnswer?"text-orange":""].join(" "),children:[e("h4",{className:"w-6 text-xl font-bold",children:r+1}),s.value]},r))]})}const ke=()=>{var a;const{id:t}=_();if(!t)return e(y,{message:"Missing assessment Id"});const{assessment:s,error:r,loading:i}=k(t);return i?e(w,{}):r?e(y,{message:r.toString()}):n("div",{className:"flex flex-col gap-8",children:[e(M,{title:"Preguntas",cta:e(b,{to:"new",className:"bg-blue px-4 py-2 rounded-md text-white",children:"Agregar Pregunta"})}),s!==void 0?!!s.questions&&((a=s.questions)==null?void 0:a.length)>0?s.questions.map((o,l)=>e(_e,{question:o},l)):e(N,{type:"info",title:"Oops, no hay preguntas",message:"Agrega una pregunta"}):e(N,{type:"error",title:"Oops, no encontr\xE9 ese quiz",message:"Intenta con otro"})]})},Oe=(t,s)=>{const r=t.slice();switch(s.type){case"add":return r.splice(r.length,0,{discriminator:"option",value:"",isCorrectAnswer:!1}),r;case"remove":if(s.index===void 0)throw"Missing index";return confirm(`Est\xE1s a punto de quitar la ${s.index+1} opci\xF3n`)?(r.splice(s.index,1),r):t;case"change":if(s.index===void 0)throw"Missing index";if(!s.item)throw"Missing item";return r.map((i,a)=>a!==s.index?{...i}:{...i,...s.item})}},$e=t=>{const[s,r]=u.exports.useReducer(Oe,[]),i=(a,o)=>l=>{r({type:"change",index:a,item:o=="isCorrect"?{isCorrectAnswer:l.currentTarget.checked}:{value:l.currentTarget.value}})};return u.exports.useEffect(()=>{t.setValue("options[]",s)},[s]),e("div",{className:"mt-16",children:n(x,{children:[s.map((a,o)=>n("div",{className:"mb-8",children:[e("hr",{className:"mb-4"}),n(A,{spacing:4,className:"mb-4",children:[n("h4",{className:"grow w-6 text-2xl font-bold",children:["Opci\xF3n ",o+1,":"]}),e(O,{onClick:()=>r({type:"remove",index:o}),children:e(re,{})})]}),n(A,{spacing:4,grow:!0,children:[n("div",{className:"grow",children:[e("label",{htmlFor:`${o}-value`,className:"mb-2 block",children:"Respuesta"}),e("input",{id:`${o}-value`,type:"text",onChange:i(o,"value"),value:a.value,className:"grow w-full",autoComplete:"none"})]}),n("div",{children:[e("label",{htmlFor:`${o}-isCorrect`,className:"block",children:"Es Correcta"}),e("input",{id:`${o}-isCorrect`,type:"checkbox",onChange:i(o,"isCorrect"),defaultChecked:a.isCorrectAnswer})]})]})]},o)),e(O,{onClick:()=>r({type:"add"}),className:"!mx-auto !block",children:e(j,{})})]})})},U=t=>{const{id:s,questionId:r}=_();if(!s)return e(y,{message:"Missing assessment id"});const[i,a]=u.exports.useState(),o=R(),[l,c]=u.exports.useState("MULTIPLE_CHOICE"),[d,p]=u.exports.useState(!1),f=()=>{a({type:"info",content:"La pregunta se agreg\xF3 correctamente"}),p(!0),setTimeout(()=>o("../"),2e3)},S=v=>{a({type:"error",content:v})};t.questionHook||(t.questionHook=B);const{mutate:q,error:C,isLoading:E,reset:m}=t.questionHook({assessmentId:s,questionId:r,onSuccess:f,onError:S}),{register:F,handleSubmit:h,setValue:K,formState:W}=L(),J=v=>v.options.length>=2&&v.options.some(X=>X.isCorrectAnswer);return n("form",{onSubmit:h(v=>{if(a(void 0),m(),J(v))return q(v);S("La pregunta no es v\xE1lida")}),className:"text-left flex flex-col items-stretch gap-6 mb-16 relative",children:[e(M,{back:!0,title:"Nueva Pregunta"}),!d&&n("div",{className:"flex flex-col gap-4",children:[e(I,{type:"text",register:F,name:"title",required:!0}),n("div",{className:"flex flex-col gap-1",children:[e("label",{htmlFor:"type",children:"Tipo:"}),n("select",{...F("type"),onChange:v=>c(v.currentTarget.value),required:!0,children:[e("option",{value:"MULTIPLE_CHOICE",children:"Opci\xF3n M\xFAltiple"}),e("option",{value:"BOOLEAN",children:"S\xED o No"})]}),e("input",{type:"hidden",...F("options[]"),required:!0}),l==="MULTIPLE_CHOICE"?e($e,{setValue:K}):e(x,{})]})]}),!!C&&e(N,{type:"error",title:"Error",message:C.toString()}),i!==void 0&&!C&&e(N,{type:i.type,message:i.content.toString(),title:i.type=="error"?"Error":"\xC9xito"}),E?e(w,{}):e("input",{type:"submit",value:"Crear",disabled:!W.isValid&&!d,className:"px-8 py-2 bg-blue rounded-md text-white cursor-pointer hover:bg-primary-40 mx-auto"})]})};function Re(t){const{register:s,handleSubmit:r,setValue:i,formState:a,getValues:o}=L({defaultValues:{title:t.assessment.title,description:t.assessment.description,categories:t.assessment.categories}}),[l,c]=u.exports.useState(),[d,p]=u.exports.useState(!1),f=R(),S=h=>{c({type:"info",content:`Cambios en "${h.title}" se guardaron correctamente`}),p(!0),setTimeout(()=>f("../"),2e3)},q=h=>{c({type:"error",content:h})},{mutate:C,error:E,isLoading:m}=ae(S,q),F=h=>{!!h.title&&confirm(`\xBFModificar ${h.title}?`)&&C({...t.assessment,...h})};return n("form",{onSubmit:r(h=>F(h)),className:"text-left flex flex-col items-stretch gap-6 mb-16 relative",children:[!!E&&e(N,{type:"error",title:"Error",message:E.toString()}),l!==void 0&&e(N,{type:l.type,message:l.content,title:l.type=="error"?"Error":"\xC9xito"}),!d&&n("div",{className:"flex flex-col gap-4",children:[e(I,{type:"text",register:s,name:"title",required:!0}),e(I,{type:"textarea",register:s,name:"description"}),e(G,{register:s,name:"categories",setValue:i,defaultValue:o().categories})]}),m?e(w,{}):e("input",{type:"submit",value:"Guardar",disabled:!a.isValid&&!d,className:"px-8 py-2 bg-blue rounded-md text-white cursor-pointer hover:bg-primary-40 mx-auto"})]})}const Le=()=>{const{id:t}=_();if(!t)return e(y,{message:"No ID Found in route"});const{assessment:s,error:r,loading:i}=k(t);return i?e(w,{}):r?e(y,{message:r.toString()}):e(x,{children:e(Re,{assessment:s})})},Ve=Le,He=()=>n(oe,{children:[e(g,{index:!0,element:e(Ce,{})}),e(g,{path:"new",element:e(Fe,{})}),n(g,{path:":id",element:e(ve,{}),children:[e(g,{index:!0,element:e(le,{to:"details"})}),e(g,{path:"details",element:e(Ie,{})}),n(g,{path:"questions",children:[e(g,{path:"",element:e(ke,{})}),e(g,{path:"new",element:e(U,{questionHook:B})}),e(g,{path:":questionId",element:e(U,{questionHook:ne})})]}),e(g,{path:"ratings",element:e(M,{title:"Rese\xF1as"})}),e(g,{path:"edit",element:e(Ve,{})})]}),e(g,{path:"*",element:e(ce,{})})]});export{He as default};
