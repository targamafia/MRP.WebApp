import{r as U,i as Q,a as j,E as x,u as P,M as D,T as _,d as ee,b as te,I as O,c as se,e as W,A as re,f as ae,g as ne,h as ie,j as oe,k as le,l as ce,m as ue}from"./appRouter.17b719b0.js";import{j as e,U as w,a as n,F as b,r as d}from"./index.fa45f22a.js";import{d as L,N as C,R as A,O as de,u as V,a as me,b as f,e as ge,c as he}from"./404.12e00d23.js";import{C as J,d as pe,M as fe,B as xe,a as v,b as ve,u as R,I as q}from"./index.esm.950bd702.js";var z={},be=Q.exports;Object.defineProperty(z,"__esModule",{value:!0});var B=z.default=void 0,ye=be(U()),Ne=j,Ce=(0,ye.default)((0,Ne.jsx)("path",{d:"m14.06 9.02.92.92L5.92 19H5v-.92l9.06-9.06M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z"}),"EditOutlined");B=z.default=Ce;const we=()=>{const{id:t}=L();if(!t)return e(x,{message:"Missing assessment Id"});const{assessment:s,error:r,loading:i}=P(t);return e(D,{bgImg:s==null?void 0:s.thumbnailUrl,children:i?e(w,{}):r?e(x,{message:r.toString()}):s!==void 0?n(b,{children:[e("div",{className:"my-2 mb-12",children:e(_,{title:s.title,back:!0,cta:e(C,{to:"./edit",children:e(B,{})})})}),n(A,{spacing:4,className:"mb-8",items:"center",children:[e(C,{to:"./details",className:({isActive:a})=>(a?"bg-blue text-white rounded-md hover:text-white":"text-main hover:text-main")+" px-4 py-2",children:"Detalles"}),e(C,{to:"./questions",className:({isActive:a})=>(a?"bg-blue text-white rounded-md hover:text-white":"text-main hover:text-main")+" px-4 py-2",children:"Preguntas"}),e(C,{to:"./ratings",className:({isActive:a})=>(a?"bg-blue text-white rounded-md hover:text-white":"text-main hover:text-main")+" px-4 py-2",children:"Rese\xF1as"})]}),e(de,{})]}):e(b,{})})},Ee=t=>e(C,{to:`/MRP.WebApp/assessments/${t.id}`,children:e("div",{className:"rounded-md bg-surface-4 text-main hover:bg-surface-5 transition-colors duration-300 overflow-hidden shadow-sm outline outline-solid outline-surface-2 hover:outline-white hover:shadow-glow w-full ",children:n("div",{className:"grid grid-cols-[minmax(2rem,8rem)_1fr_2rem] items-center pr-4",children:[t.thumbnailUrl!==void 0?e("img",{src:t.thumbnailUrl,className:"w-f self-stretch object-cover grow"}):e("div",{}),n("div",{className:"grow p-4 flex items-start self-start flex-col pointer-events-none",children:[t.categories!==void 0&&e(J,{elements:t.categories}),e("h3",{className:"text-3xl mb-2",children:t.title}),t.description!==void 0&&e("p",{className:"mb-4",children:t.description})]}),e(ee,{color:"info"})]})})}),Se=t=>e("div",{className:"flex flex-col gap-8",children:t.assessments!==void 0&&t.assessments.map(s=>e(Ee,{...s},s.id))}),qe=t=>{const[s,r]=d.exports.useState([]),i=()=>{if(!t.assessments)return r([]);const a=[];for(var o=0;o<t.assessments.length;o++){const u=t.assessments[o];for(var l=0;l<u.categories.length;l++){const g=u.categories[l];a.includes(g)||a.push(g)}}r(a)};return d.exports.useMemo(()=>{i()},[t.assessments]),n("div",{className:"max-w-xs rounded-md",children:[e("h2",{className:"mb-2",children:"Filtros"}),n("div",{className:"flex flex-row gap-4 items-center relative my-4",children:[e("h3",{className:"mt-4 hidden","aria-hidden":!0,children:"Buscar"}),e("input",{type:"text",id:"query",placeholder:"Buscar",autoComplete:"off","aria-label":"Buscar",className:"outline outline-neutral-70 w-full mt-2 placeholder:text-neutral-50 pl-10",onChange:a=>t.dispatch({property:"query",value:a.currentTarget.value})}),e(pe,{className:"absolute left-2 mt-1 top-1/2 -translate-y-1/2"})]}),e("h3",{className:"mt-4",children:"Categor\xEDas"}),e(fe,{allOptions:s,selectedOptions:t.state.categories,onChange:a=>t.dispatch({property:"categories",value:a})})]})},Me=(t,s)=>{switch(s.property){case"categories":return t.categories.includes(s.value)?{...t,categories:t.categories.filter(r=>r!=s.value)}:{...t,categories:[s.value,...t.categories]};case"query":return{...t,query:s.value};default:return console.error("Unkown action property"),{...t}}},Ae=()=>{const{assessments:t,loading:s,error:r}=te(),[i,a]=d.exports.useReducer(Me,{categories:[],query:""}),o=d.exports.useMemo(()=>{if(!t)return[];const l=i.query!="",u=i.categories.length>0,g=new RegExp(i.query,"ig");return t.filter(h=>(!u||h.categories.some(p=>i.categories.includes(p)))&&(!l||[h.title,h.categories.join(" "),h.description].some(p=>p!==void 0&&g.test(p))))},[t,i.categories,i.query]);return n(D,{sidebar:e(qe,{assessments:t,state:i,dispatch:a}),children:[e(_,{cta:e(C,{to:"new",className:"block",children:e(xe,{variant:"contained",children:"Crear nuevo Quiz"})}),title:"Quizes"}),s?e(w,{}):e(b,{}),r?e(v,{type:"error",title:"Error",message:r.toString()}):e(b,{}),!s&&!r?e(Se,{assessments:o}):e(b,{})]})};var H={},Ie=Q.exports;Object.defineProperty(H,"__esModule",{value:!0});var G=H.default=void 0,_e=Ie(U()),Fe=j,Le=(0,_e.default)((0,Fe.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"AddOutlined");G=H.default=Le;const X=t=>{const s=d.exports.useRef(null),[r,i]=d.exports.useState(t.defaultValue||[]),a=t.name[0].toLocaleUpperCase()+t.name.slice(1),o=()=>{s===null||s.current===null||(i([s.current.value.trim(),...r]),s.current.value="")},l=u=>{i(r.filter(g=>g!==u.value))};return d.exports.useEffect(()=>{t.setValue(t.name+"[]",r)},[r]),n("div",{className:"flex flex-col gap-4 w-full",children:[e("input",{type:"hidden",...t.register(t.name+"[]")}),n("div",{className:"flex flex-row gap-4 w-full items-end",children:[n("div",{className:"flex flex-col gap-1 grow",children:[n("label",{htmlFor:"multiselect",children:[a,":"]}),e("textarea",{onKeyUp:u=>{u.key=="Enter"&&(u.preventDefault(),o())},onSubmit:u=>{u.preventDefault(),o()},rows:1,className:"resize-none",placeholder:a,id:"multiselect",ref:s})]}),e(O,{"aria-label":"add",onClick:o,children:e(G,{color:"primary"})})]}),e(A,{spacing:4,wrap:!0,children:r.map(u=>e(ve,{color:"primary",label:u,onDelete:()=>l({value:u})},u))})]})},$e=()=>{const{register:t,handleSubmit:s,setValue:r,formState:i}=R(),[a,o]=d.exports.useState(),[l,u]=d.exports.useState(!1),g=V(),h=m=>{o({type:"info",content:`"${m.title}" se cre\xF3 exitosamente`}),u(!0),setTimeout(()=>g("../"),2e3)},p=m=>{o({type:"error",content:m})},{mutate:E,error:y,isLoading:I}=se(h,p),N=m=>{confirm(`\xBFCrear ${m.title}?`)&&E(m)};return n("form",{onSubmit:s(m=>N(m)),className:"text-left flex flex-col items-stretch gap-6 mb-16 relative",children:[!!y&&e(v,{type:"error",title:"Error",message:y.toString()}),a!==void 0&&e(v,{type:a.type,message:a.content,title:a.type=="error"?"Error":"\xC9xito"}),!l&&n("div",{className:"flex flex-col gap-4",children:[e(q,{type:"text",register:t,name:"title",required:!0}),e(q,{type:"textarea",register:t,name:"description"}),e(X,{register:t,name:"categories",setValue:r})]}),I?e(w,{}):!l&&e("input",{type:"submit",value:"Crear",disabled:!i.isValid&&!l,className:"px-8 py-2 bg-blue rounded-md text-white cursor-pointer hover:bg-primary-40 mx-auto"})]})},Oe=()=>n(D,{children:[n(A,{spacing:2,items:"center",wrap:!1,children:[e(C,{to:"../",className:"mb-8",children:e(W,{})}),e("h1",{className:"mb-8 grow",children:"Nuevo Quiz"})]}),e($e,{})]}),Pe=()=>{const{id:t}=L();if(!t)return e(x,{message:"Missing assessment Id"});const{assessment:s,error:r,loading:i}=P(t);return i?e(w,{}):r?e(x,{message:r.toString()}):s!==void 0?n(b,{children:[e(_,{title:"Detalles"}),e("h2",{children:"Categor\xEDas"}),s.categories!==void 0&&e(J,{elements:s.categories}),e("hr",{className:"my-4"}),e("h2",{className:"mb-2",children:"Descripci\xF3n"}),e("p",{className:"mb-8",children:s.description!==void 0?s.description:"Sin descripci\xF3n"}),e("hr",{className:"my-4"}),e("h2",{className:"mb-4",children:"Vista Previa"}),e("div",{className:"p-8 rounded-md bg-surface-2",children:e(re,{...s,id:t})})]}):e(b,{})};var K={},Ve=Q.exports;Object.defineProperty(K,"__esModule",{value:!0});var Y=K.default=void 0,Re=Ve(U()),Te=j,ke=(0,Re.default)((0,Te.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline");Y=K.default=ke;function Ue(t){const{mutate:s,error:r,isLoading:i}=ae(t.assessmentId,t.question._id),a=()=>{!confirm(`Est\xE1s a punto de borrar la pregunta ${t.question.title}, esto no se puede deshacer.
    \xBFQuieres continuar?`)||s(t.question)};return n("div",{className:"rounded-md p-4 bg-surface-3",children:[n(A,{spacing:2,className:"mb-4",children:[e("h3",{className:"mb-0 text-2xl font-bold grow",children:t.question.title}),e(C,{to:t.question._id,className:"p-2",children:e(B,{})}),e(O,{onClick:a,children:e(Y,{})})]}),t.question.options.map((o,l)=>n("div",{className:["p-2 flex flex-row gap-4",o.isCorrectAnswer?"text-orange":""].join(" "),children:[e("h4",{className:"w-6 text-xl font-bold",children:l+1}),o.value]},l))]})}const Qe=()=>{var a;const{id:t}=L();if(!t)return e(x,{message:"Missing assessment Id"});const{assessment:s,error:r,loading:i}=P(t);return i?e(w,{}):r?e(x,{message:r.toString()}):n("div",{className:"flex flex-col gap-8",children:[e(_,{title:"Preguntas",cta:e(C,{to:"new",className:"bg-blue px-4 py-2 rounded-md text-white",children:"Agregar Pregunta"})}),s!==void 0?!!s.questions&&((a=s.questions)==null?void 0:a.length)>0?s.questions.map((o,l)=>e(Ue,{question:o,assessmentId:s._id||s.id},l)):e(v,{type:"info",title:"Oops, no hay preguntas",message:"Agrega una pregunta"}):e(v,{type:"error",title:"Oops, no encontr\xE9 ese quiz",message:"Intenta con otro"})]})},je=(t,s)=>{const r=t.slice();switch(s.type){case"add":return r.splice(r.length,0,{discriminator:"option",value:"",isCorrectAnswer:!1}),r;case"remove":if(s.index===void 0)throw"Missing index";return confirm(`Est\xE1s a punto de quitar la ${s.index+1} opci\xF3n`)?(r.splice(s.index,1),r):t;case"change":if(s.index===void 0)throw"Missing index";if(!s.item)throw"Missing item";return r.map((i,a)=>a!==s.index?{...i}:{...i,...s.item})}},Z=t=>{const[s,r]=d.exports.useReducer(je,t.defaultValue||[]),i=(a,o)=>l=>{r({type:"change",index:a,item:o=="isCorrect"?{isCorrectAnswer:l.currentTarget.checked}:{value:l.currentTarget.value}})};return d.exports.useEffect(()=>{t.setValue(t.name,s)},[s]),e("div",{className:"mt-16",children:n(b,{children:[s.map((a,o)=>n("div",{className:"mb-8",children:[e("hr",{className:"mb-4"}),n(A,{spacing:4,className:"mb-4",children:[n("h4",{className:"grow w-6 text-2xl font-bold",children:["Opci\xF3n ",o+1,":"]}),e(O,{onClick:()=>r({type:"remove",index:o}),children:e(ne,{})})]}),n(A,{spacing:4,grow:!0,children:[n("div",{className:"grow",children:[e("label",{htmlFor:`${o}-value`,className:"mb-2 block",children:"Respuesta"}),e("input",{id:`${o}-value`,type:"text",onChange:i(o,"value"),value:a.value,className:"grow w-full",autoComplete:"none"})]}),n("div",{children:[e("label",{htmlFor:`${o}-isCorrect`,className:"block",children:"Es Correcta"}),e("input",{id:`${o}-isCorrect`,type:"checkbox",onChange:i(o,"isCorrect"),defaultChecked:a.isCorrectAnswer})]})]})]},o)),e(O,{onClick:()=>r({type:"add"}),className:"!mx-auto !block",children:e(G,{})})]})})},De=()=>{const{id:t,questionId:s}=L();if(!t)return e(x,{message:"Missing assessment id"});const[r,i]=d.exports.useState(),a=V(),[o,l]=d.exports.useState("MULTIPLE_CHOICE"),[u,g]=d.exports.useState(!1),h=()=>{i({type:"info",content:"La pregunta se agreg\xF3 correctamente"}),g(!0),setTimeout(()=>a("../"),2e3)},p=c=>{i({type:"error",content:c})},{mutate:E,error:y,isLoading:I,reset:N}=ie({assessmentId:t,onSuccess:h,onError:p}),{register:m,handleSubmit:S,setValue:F,formState:M}=R(),$=c=>c.options.length>=2&&c.options.some(k=>k.isCorrectAnswer);return n("form",{onSubmit:S(c=>{if(i(void 0),N(),$(c))return E(c);p("La pregunta no es v\xE1lida")}),className:"text-left flex flex-col items-stretch gap-6 mb-16 relative",children:[e(_,{back:!0,title:"Nueva Pregunta"}),!u&&n("div",{className:"flex flex-col gap-4",children:[e(q,{type:"text",register:m,name:"title",required:!0}),n("div",{className:"flex flex-col gap-1",children:[e("label",{htmlFor:"type",children:"Tipo:"}),n("select",{...m("type"),onChange:c=>l(c.currentTarget.value),required:!0,children:[e("option",{value:"MULTIPLE_CHOICE",children:"Opci\xF3n M\xFAltiple"}),e("option",{value:"BOOLEAN",children:"S\xED o No"})]}),e("input",{type:"hidden",...m("options"),required:!0}),o==="MULTIPLE_CHOICE"?e(Z,{setValue:F,name:"options"}):e(b,{})]})]}),!!y&&e(v,{type:"error",title:"Error",message:y.toString()}),r!==void 0&&!y&&e(v,{type:r.type,message:r.content.toString(),title:r.type=="error"?"Error":"\xC9xito"}),I?e(w,{}):!u&&e("input",{type:"submit",value:"Crear",disabled:!M.isValid&&!u,className:"px-8 py-2 bg-blue rounded-md text-white cursor-pointer hover:bg-primary-40 mx-auto"})]})};function ze(t){const{register:s,handleSubmit:r,setValue:i,formState:a,getValues:o}=R({defaultValues:{...t.assessment}}),[l,u]=d.exports.useState(),[g,h]=d.exports.useState(!1),p=V(),E=c=>{u({type:"info",content:`Cambios en "${c.title}" se guardaron correctamente`}),h(!0),setTimeout(()=>p("../"),2e3)},y=c=>{u({type:"error",content:c})},{mutate:I,error:N,isLoading:m}=oe(E,y),{mutate:S,error:F,isLoading:M}=le(()=>p("../../")),$=()=>{!confirm(`Est\xE1s a punto de borrar ${t.assessment.title}, esto no se puede deshacer.
        \xBFQuieres continuar?`)||(S(t.assessment._id||t.assessment.id),h(!0),u({type:"info",content:`${t.assessment.title} se borr\xF3 correctamente`}))},T=c=>{!!c.title&&confirm(`\xBFModificar ${c.title}?`)&&I({...t.assessment,...c})};return n("form",{onSubmit:r(c=>T(c)),className:"text-left flex flex-col items-stretch gap-6 mb-16 relative",children:[!!N&&e(v,{type:"error",title:"Error",message:N.toString()}),!!F&&e(v,{type:"error",title:"Error",message:F.toString()}),l!==void 0&&e(v,{type:l.type,message:l.content,title:l.type=="error"?"Error":"\xC9xito"}),!g&&n("div",{className:"flex flex-col gap-4",children:[e(C,{to:"../",children:e(W,{})}),e(q,{type:"text",register:s,name:"title",required:!0}),e(q,{type:"textarea",register:s,name:"description"}),e(q,{type:"text",register:s,name:"thumbnailUrl",label:"URL de la foto"}),n(A,{className:"gap-16 mx-auto",children:[e(q,{type:"checkbox",register:s,name:"isPrivate",label:"Examen Privado"}),e(q,{type:"checkbox",register:s,name:"isPremium",label:"Examen Premium"})]}),e(X,{register:s,name:"categories",setValue:i,defaultValue:o().categories})]}),m||M?e(w,{}):n(A,{spacing:4,items:"stretch",justify:"center",children:[e("div",{className:"bg-error-50 rounded-md text-white px-8 py-2 hover:bg-error-60 cursor-pointer",onClick:$,children:"Delete"}),e("input",{type:"submit",value:"Guardar",disabled:!a.isValid&&!g,className:"px-8 py-2 bg-blue rounded-md text-white cursor-pointer hover:bg-primary-40"})]})]})}const Be=()=>{const{id:t}=L();if(!t)return e(x,{message:"No ID Found in route"});const{assessment:s,error:r,loading:i}=P(t);return i?e(w,{}):r?e(x,{message:r.toString()}):e(b,{children:e(ze,{assessment:s})})},He=Be,Ge=t=>{const[s,r]=d.exports.useState(),i=V(),[a,o]=d.exports.useState("MULTIPLE_CHOICE"),[l,u]=d.exports.useState(!1),g=()=>{r({type:"info",content:"La pregunta se agreg\xF3 correctamente"}),u(!0),setTimeout(()=>i("../"),2e3)},h=c=>{r({type:"error",content:c})},{mutate:p,error:E,isLoading:y,reset:I}=ce({assessmentId:t.assessmentId,questionId:t.question._id,onSuccess:g,onError:h}),{register:N,handleSubmit:m,setValue:S,formState:F,getValues:M}=R({defaultValues:{...t.question}});d.exports.useEffect(()=>{S("title",t.question.title),S("imageUrl",t.question.imageUrl),S("options",t.question.options),S("type",t.question.type)},[t.question]);const $=c=>c.options.length>=2&&c.options.some(k=>k.isCorrectAnswer);return n("form",{onSubmit:m(c=>{if(r(void 0),I(),$(c))return p(c);h("La pregunta no es v\xE1lida")}),className:"text-left flex flex-col items-stretch gap-6 mb-16 relative",children:[e(_,{back:!0,title:"Editar Pregunta"}),!l&&n("div",{className:"flex flex-col gap-4",children:[e(q,{type:"text",register:N,name:"title",required:!0}),n("div",{className:"flex flex-col gap-1",children:[e("label",{htmlFor:"type",children:"Tipo:"}),n("select",{...N("type",{required:!0}),onChange:c=>o(c.currentTarget.value),value:M().type,children:[e("option",{value:"MULTIPLE_CHOICE",children:"Opci\xF3n M\xFAltiple"}),e("option",{value:"BOOLEAN",children:"S\xED o No"})]}),e("input",{type:"hidden",...N("options",{required:!0}),value:M().options&&M().options.toString()||""}),a==="MULTIPLE_CHOICE"?e(Z,{setValue:S,name:"options",defaultValue:M().options}):e(b,{})]})]}),!!E&&e(v,{type:"error",title:"Error",message:E.toString()}),s!==void 0&&!E&&e(v,{type:s.type,message:s.content.toString(),title:s.type=="error"?"Error":"\xC9xito"}),y?e(w,{}):!l&&e("input",{type:"submit",value:"Actualizar",disabled:!F.isValid&&!l,className:"px-8 py-2 bg-blue rounded-md text-white cursor-pointer hover:bg-primary-40 mx-auto"})]})},Ke=()=>{const{id:t,questionId:s}=L();if(!t)return e(x,{message:"Missing assessment id"});if(!s)return e(x,{message:"Missing question id"});const{question:r,error:i,loading:a}=ue({assessmentId:t,questionId:s});return a?e(w,{}):i?e(x,{message:i.toString()}):e(Ge,{question:r,assessmentId:t})},We=Ke,et=()=>n(me,{children:[e(f,{index:!0,element:e(Ae,{})}),e(f,{path:"new",element:e(Oe,{})}),n(f,{path:":id",element:e(we,{}),children:[e(f,{index:!0,element:e(ge,{to:"details"})}),e(f,{path:"details",element:e(Pe,{})}),n(f,{path:"questions",children:[e(f,{path:"",element:e(Qe,{})}),e(f,{path:"new",element:e(De,{})}),e(f,{path:":questionId",element:e(We,{})})]}),e(f,{path:"ratings",element:e(_,{title:"Rese\xF1as"})}),e(f,{path:"edit",element:e(He,{})})]}),e(f,{path:"*",element:e(he,{})})]});export{et as default};
