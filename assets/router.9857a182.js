import{q as Q,s as Y,t as $,B as X,C as Z,F as ee,v as se,x as F,y as ae,D as re,G as ne,M as S,T as _,H as R,g as oe,E as f,J as te,K as ie,L as le,N as ce}from"./appRouter.823e256f.js";import{r as m,o as u,_ as c,y,n as de,j as a,b as n,a as P,N as A,F as E,O as L,Y as ue,a1 as I,Q as T,R as pe,c as h,a2 as me}from"./index.459b5a60.js";import{d as xe,M as ge,a as q,u as he,I as N,N as M,A as ve}from"./index.esm.bd5afd69.js";import{R as z,N as fe}from"./404.ae2c6307.js";function be(e){return Y("MuiButton",e)}const ye=Q("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),C=ye,Ne=m.exports.createContext({}),Ce=Ne,ze=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Ie=e=>{const{color:s,disableElevation:r,fullWidth:t,size:o,variant:i,classes:l}=e,d={root:["root",i,`${i}${u(s)}`,`size${u(o)}`,`${i}Size${u(o)}`,s==="inherit"&&"colorInherit",r&&"disableElevation",t&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${u(o)}`],endIcon:["endIcon",`iconSize${u(o)}`]},p=ae(d,be,l);return c({},l,p)},D=e=>c({},e.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},e.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},e.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),$e=$(X,{shouldForwardProp:e=>Z(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,s)=>{const{ownerState:r}=e;return[s.root,s[r.variant],s[`${r.variant}${u(r.color)}`],s[`size${u(r.size)}`],s[`${r.variant}Size${u(r.size)}`],r.color==="inherit"&&s.colorInherit,r.disableElevation&&s.disableElevation,r.fullWidth&&s.fullWidth]}})(({theme:e,ownerState:s})=>{var r,t;return c({},e.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":c({textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:y(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},s.variant==="text"&&s.color!=="inherit"&&{backgroundColor:e.vars?`rgba(${e.vars.palette[s.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:y(e.palette[s.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},s.variant==="outlined"&&s.color!=="inherit"&&{border:`1px solid ${(e.vars||e).palette[s.color].main}`,backgroundColor:e.vars?`rgba(${e.vars.palette[s.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:y(e.palette[s.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},s.variant==="contained"&&{backgroundColor:(e.vars||e).palette.grey.A100,boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2],backgroundColor:(e.vars||e).palette.grey[300]}},s.variant==="contained"&&s.color!=="inherit"&&{backgroundColor:(e.vars||e).palette[s.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[s.color].main}}),"&:active":c({},s.variant==="contained"&&{boxShadow:(e.vars||e).shadows[8]}),[`&.${C.focusVisible}`]:c({},s.variant==="contained"&&{boxShadow:(e.vars||e).shadows[6]}),[`&.${C.disabled}`]:c({color:(e.vars||e).palette.action.disabled},s.variant==="outlined"&&{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},s.variant==="outlined"&&s.color==="secondary"&&{border:`1px solid ${(e.vars||e).palette.action.disabled}`},s.variant==="contained"&&{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground})},s.variant==="text"&&{padding:"6px 8px"},s.variant==="text"&&s.color!=="inherit"&&{color:(e.vars||e).palette[s.color].main},s.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},s.variant==="outlined"&&s.color!=="inherit"&&{color:(e.vars||e).palette[s.color].main,border:e.vars?`1px solid rgba(${e.vars.palette[s.color].mainChannel} / 0.5)`:`1px solid ${y(e.palette[s.color].main,.5)}`},s.variant==="contained"&&{color:e.vars?e.vars.palette.text.primary:(r=(t=e.palette).getContrastText)==null?void 0:r.call(t,e.palette.grey[300]),backgroundColor:(e.vars||e).palette.grey[300],boxShadow:(e.vars||e).shadows[2]},s.variant==="contained"&&s.color!=="inherit"&&{color:(e.vars||e).palette[s.color].contrastText,backgroundColor:(e.vars||e).palette[s.color].main},s.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},s.size==="small"&&s.variant==="text"&&{padding:"4px 5px",fontSize:e.typography.pxToRem(13)},s.size==="large"&&s.variant==="text"&&{padding:"8px 11px",fontSize:e.typography.pxToRem(15)},s.size==="small"&&s.variant==="outlined"&&{padding:"3px 9px",fontSize:e.typography.pxToRem(13)},s.size==="large"&&s.variant==="outlined"&&{padding:"7px 21px",fontSize:e.typography.pxToRem(15)},s.size==="small"&&s.variant==="contained"&&{padding:"4px 10px",fontSize:e.typography.pxToRem(13)},s.size==="large"&&s.variant==="contained"&&{padding:"8px 22px",fontSize:e.typography.pxToRem(15)},s.fullWidth&&{width:"100%"})},({ownerState:e})=>e.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${C.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${C.disabled}`]:{boxShadow:"none"}}),Re=$("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,s)=>{const{ownerState:r}=e;return[s.startIcon,s[`iconSize${u(r.size)}`]]}})(({ownerState:e})=>c({display:"inherit",marginRight:8,marginLeft:-4},e.size==="small"&&{marginLeft:-2},D(e))),Ae=$("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,s)=>{const{ownerState:r}=e;return[s.endIcon,s[`iconSize${u(r.size)}`]]}})(({ownerState:e})=>c({display:"inherit",marginRight:-4,marginLeft:8},e.size==="small"&&{marginRight:-2},D(e))),Ee=m.exports.forwardRef(function(s,r){const t=m.exports.useContext(Ce),o=ee(t,s),i=se({props:o,name:"MuiButton"}),{children:l,color:d="primary",component:p="button",className:x,disabled:g=!1,disableElevation:O=!1,disableFocusRipple:k=!1,endIcon:w,focusVisibleClassName:W,fullWidth:j=!1,size:G="medium",startIcon:U,type:B,variant:V="text"}=i,H=de(i,ze),b=c({},i,{color:d,component:p,disabled:g,disableElevation:O,disableFocusRipple:k,fullWidth:j,size:G,type:B,variant:V}),v=Ie(b),J=U&&a(Re,{className:v.startIcon,ownerState:b,children:U}),K=w&&a(Ae,{className:v.endIcon,ownerState:b,children:w});return n($e,c({ownerState:b,className:F(t.className,v.root,x),component:p,disabled:g,focusRipple:!k,focusVisibleClassName:F(v.focusVisible,W),ref:r,type:B},H,{classes:v,children:[J,l,K]}))}),ke=Ee,we=e=>{const[s,r]=m.exports.useState([]),t=()=>{if(!e.users)return r([]);const o=[];for(var i=0;i<e.users.length;i++){const d=e.users[i];for(var l=0;l<d.roles.length;l++){const p=d.roles[l];o.includes(p)||o.push(p)}}r(o)};return m.exports.useMemo(()=>{t()},[e.users]),n("div",{className:"rounded-md flex flex-row gap-8",children:[n("div",{className:"flex flex-row gap-4 items-center relative my-4 grow",children:[a("h3",{className:"mt-4 hidden","aria-hidden":!0,children:"Buscar"}),a("input",{type:"text",id:"query",placeholder:"Buscar",autoComplete:"off","aria-label":"Buscar",className:"outline outline-neutral-70 w-full mt-2 placeholder:text-neutral-50 pl-10",onChange:o=>e.dispatch({property:"query",value:o.currentTarget.value})}),a(xe,{className:"absolute left-2 mt-1 top-1/2 -translate-y-1/2"})]}),n("div",{className:"flex flex-col grow",children:[a("h3",{className:"mt-4",children:"Rol"}),a(ge,{allOptions:s,selectedOptions:e.state.roles,onChange:o=>e.dispatch({property:"roles",value:o})})]})]})},Ue=e=>{const s=P();return n("tr",{className:"bg-surface-4 text-main rounded-lg cursor-pointer hover:bg-surface-5 hover:border-surface-1 hover:shadow-sm overflow-hidden",onClick:()=>s(e.user._id||e.user.id||""),children:[a("td",{className:"px-4 py-2",children:n("h3",{children:[e.user.name," ",e.user.lastName]})}),a("td",{className:"px-4 py-2",children:a("p",{children:e.user.email})}),a("td",{className:"px-4 py-2",children:a("p",{children:e.user.companyCode})}),a("td",{className:"px-4 py-2 image.pngpointer-events-none",children:a(q,{elements:e.user.roles,noMargin:!0})}),a("td",{className:"",children:a(A,{to:e.user.id||"",children:a(re,{color:"info"})})})]})},Be=e=>n("div",{className:"flex flex-col gap-4",children:[a("div",{className:"px-4 grid grid-cols-[minmax(max-content,_1fr)_minmax(max-content,_1fr)_minmax(max-content,_1fr)_minmax(min-content,_1fr)_1rem] gap-4 items-center pr-4"}),n("table",{className:"items-center border-spacing-y-2 border-separate",children:[a("thead",{children:n("tr",{className:"text-left",children:[a("th",{className:"px-4 py-2",children:"Nombre"}),a("th",{className:"px-4 py-2",children:"Correo"}),a("th",{className:"px-4 py-2",children:"Compa\xF1ia"}),a("th",{className:"px-4 py-2",children:"Roles"}),a("th",{})]})}),a("tbody",{children:e.users.length!==0?e.users.map(s=>a(Ue,{user:s},s._id||s.id)):a("tr",{children:a("td",{children:a("p",{children:"No se encontraron usuarios"})})})})]})]}),Fe=(e,s)=>{switch(s.property){case"roles":return e.roles.includes(s.value)?{...e,roles:e.roles.filter(r=>r!=s.value)}:{...e,roles:[s.value,...e.roles]};case"query":return{...e,query:s.value};default:return console.error("Unkown action property"),{...e}}},Me=()=>{const{users:e,loading:s,error:r}=ne(),[t,o]=m.exports.useReducer(Fe,{roles:[],query:""}),i=m.exports.useMemo(()=>{if(!e)return[];const l=t.query!="",d=t.roles.length>0,p=new RegExp(t.query,"ig");return e.filter(x=>(!d||x.roles.some(g=>t.roles.includes(g)))&&(!l||[[x.name,x.lastName].join(" "),x.roles.join(" "),x.companyCode].some(g=>g!==void 0&&p.test(g))))},[e,t.roles,t.query]);return n(E,{children:[n(S,{children:[n("div",{className:"px-8 py-4 bg-surface-5 mb-12 rounded-lg shadow-inner",children:[a(_,{cta:a(A,{to:"new",className:"block",children:a(ke,{variant:"contained",children:"Crear nuevo Usuario"})}),title:"Usuarios"}),a("div",{className:"-mt-8"}),a(we,{users:e,state:t,dispatch:o})]}),a(R,{loading:s,error:r,children:()=>a(Be,{users:i})})]}),a(L,{})]})},Se=()=>{const{register:e,handleSubmit:s}=he();return n("form",{onSubmit:s(()=>{}),className:"flex flex-col gap-4",children:[a(N,{type:"text",name:"name",register:e,required:!0}),a(N,{type:"text",name:"lastName",register:e,required:!0,label:"Last Name"}),a(N,{type:"email",name:"email",register:e,required:!0}),a(N,{type:"text",name:"companyCode",register:e,label:"Company Code"}),a("input",{type:"submit",value:"Crear",className:"px-8 py-2 bg-blue rounded-md text-white cursor-pointer hover:bg-primary-40 mx-auto"})]})},_e=()=>n(S,{children:[n(z,{spacing:2,items:"center",wrap:!1,children:[a(A,{to:"../",className:"mb-8",children:a(oe,{})}),a("h1",{className:"mb-8 grow",children:"Nuevo Usuario"})]}),a(Se,{})]}),Pe=async e=>await ue("/v1/users/password-recovery-pin",{email:e});function Le(){const{id:e}=I();if(!e)return a(f,{message:"Missing assessment id"});const{stats:s,loading:r,error:t}=te(e);return a(R,{loading:r,error:t,children:()=>n("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 text-center",children:[n("div",{className:"grow p-2",children:[a("h3",{className:"text-xl",children:s.premiumAssessments}),a("p",{className:"text-sm",children:"Ex\xE1menes comprados"})]}),n("div",{className:"grow p-2",children:[a("h3",{className:"text-xl",children:s.takenAssessments}),a("p",{className:"text-sm",children:"Ex\xE1menes tomados"})]})]})})}const Te=()=>{const e=P(),{id:s}=I(),[r,t]=m.exports.useState(!1);if(!s)return a(f,{message:"Missing assessment id"});const{user:o,loading:i,error:l}=ie(s),d=()=>{Pe(o.email),t(!0)};return a(R,{loading:i,error:l,children:()=>n(E,{children:[a("div",{className:"fixed left-0 top-0 w-screen h-screen overflow-hidden bg-surface-1 bg-opacity-20 backdrop-blur-sm",onClick:()=>e("../")}),n("div",{className:"max-w-lg fixed right-0 top-0 h-screen bg-surface-5 pb-16 z-10 overflow-y-auto animate-slide-left px-8",children:[a("div",{className:"sticky top-0 bg-surface-5 pt-16 px-4 -mx-4 bg-opacity-50 backdrop-blur-sm",children:a(_,{title:o.name+" "+o.lastName,back:!0})}),n("div",{className:"flex flex-col gap-6 mb-10",children:[n("div",{className:"flex flex-col gap-1 grow",children:[a("h2",{children:"Email"}),a("p",{children:o.email})]}),n(z,{spacing:4,children:[n("div",{className:"flex flex-col gap-1 grow",children:[a("h2",{children:"Company Code"}),a("p",{children:o.companyCode||"Sin c\xF3digo"})]}),n("div",{className:"flex flex-col gap-1 grow",children:[a("h2",{children:"Rol"}),a(q,{elements:o.roles})]})]})]}),a("div",{className:"flex flex-row gap-8 my-8",children:r?a("div",{className:"px-8 py-2 bg-emerald-500 rounded-md text-white mx-auto",children:"Email enviado"}):a("div",{className:"px-8 py-2 bg-blue rounded-md text-white cursor-pointer hover:bg-primary-40 mx-auto",onClick:d,children:"Reiniciar Contrase\xF1a"})}),a("h2",{children:"M\xE9tricas"}),a(Le,{}),n(z,{spacing:4,className:"my-8 mx-auto",justify:"center",grow:!0,items:"center",children:[a(M,{to:"history",label:"Historial"}),a(M,{to:"assigned",label:"Asignados"})]}),a(L,{})]})]})})},qe=e=>{var l;const s=new Date(e.gradedAssesment.startDate),r=new Date(e.gradedAssesment.endDate),t=r.valueOf()-s.valueOf(),o=t/(60*1e3),i=e.gradedAssesment.grade;return a("div",{className:"p-4 bg-surface-4 rounded-md text-center shadow-md",children:n(z,{spacing:6,children:[n("div",{className:"text-left grow",children:[a("p",{className:"text-xs",children:s.toLocaleString()}),a("h3",{className:"text-xl",children:(l=e.gradedAssesment.assessment)==null?void 0:l.title}),n("p",{className:"mb-0 text-sm",children:[a("b",{children:"Tiempo Transcurrido:"})," ",o.toFixed(0)," m"]})]}),n("div",{className:"text-right self-stretch flex justify-center flex-col",children:[n("p",{className:["mb-0 text-2xl font-black",i<=.6?"text-red-600":i<=.8?"text-amber-400":"text-emerald-600"].join(" "),children:[(i*100).toFixed(2),"%"]}),n("p",{className:"mb-0",children:[e.gradedAssesment.correctAnswers," /"," ",e.gradedAssesment.correctAnswers+e.gradedAssesment.wrongAnswers]})]})]})})},De=e=>a("div",{className:"flex flex-col gap-4 mt-8",children:e.gradedAssessments.length>0?e.gradedAssessments.map(s=>a(qe,{gradedAssesment:s},s.id)):a("p",{children:"No Hay Ex\xE1menes"})}),Oe=e=>{var o;if(!e.userId)return a(f,{message:"Invalid user id"});let{gradedAssessments:s,error:r,loading:t}=le(e.userId);return t?a(T,{}):r?((o=r.response)==null?void 0:o.status)!=404?a(f,{message:r==null?void 0:r.toString()}):a("p",{children:"No ha contestado ning\xFAn examen"}):a(De,{gradedAssessments:s.sort((i,l)=>new Date(l.endDate).valueOf()-new Date(i.endDate).valueOf())})},We=()=>{const{id:e}=I();if(!e)throw Error("No se encontr\xF3 el id");return a(Oe,{userId:e})},je=()=>{var o;const{id:e}=I();if(!e)throw Error("No se encontr\xF3 el id");const{premiumAssessments:s,error:r,loading:t}=ce(e);return t?a(T,{}):r?((o=r.response)==null?void 0:o.status)===404?a("p",{children:"No se encontraron ex\xE1menes"}):a(f,{message:r.toString()}):n(E,{children:[a("h2",{className:"mt-12 mb-4",children:"Historial"}),s?a(ve,{assessments:s}):a("p",{children:"No se encontraron ex\xE1menes."})]})},Ge=je,Qe=()=>n(pe,{children:[a(h,{path:"",element:a(Me,{}),children:n(h,{path:":id",element:a(Te,{}),children:[a(h,{index:!0,element:a(me,{to:"history"})}),a(h,{path:"history",element:a(We,{})}),a(h,{path:"assigned",element:a(Ge,{})})]})}),a(h,{path:"new",element:a(_e,{})}),a(h,{path:"*",element:a(fe,{})})]});export{Qe as default};
